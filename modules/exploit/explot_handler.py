from messages import SuccessMessages, ErrorMessages
from .exploits import get_exploits_by_cms, get_classes_by_category
from .exploit import CMS


def exploit_runner(cms: str, url: str) -> None:
    cms = CMS(cms)
    exploits = get_exploits_by_cms(cms)
    for exploit_cls in exploits:
        exploit = exploit_cls()
        if exploit.run(url) is True:
            print(f"{SuccessMessages.VULN_TO_EXPLOIT} {exploit.name} - {exploit.cve}")
        else:
            print(f"{ErrorMessages.NO_EXPLOIT}{exploit.name}")