from ..exploit import Exploit, Categorys, CMS
from .wordpress.dprint import DprintExploit
from .wordpress.mail_masta import Masta
from .wordpress.weblizar import Weblizar
from .wordpress.product_catalog import ProductCatalog
from .wordpress.paid_membership_pro import PaidMembership
from .wordpress.wechat import WeChat
from .no_cms.astl import Astl
import inspect, sys


def get_classes_by_category(category: Categorys) -> list[Exploit]:
    exploit_classes = [cls for _, cls in inspect.getmembers(sys.modules[__name__], inspect.isclass) 
                   if issubclass(cls, Exploit) and cls != Exploit and cls.category == category]
    return exploit_classes

def get_exploits_by_cms(cms: CMS) -> list[CMS]:
    exploit_cms = [cls for _, cls in inspect.getmembers(sys.modules[__name__], inspect.isclass) 
                   if issubclass(cls, Exploit) and cls != Exploit and cls.cms == cms]
    return exploit_cms